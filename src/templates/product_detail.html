{% extends 'base.html' %}
{% load thumbnail %}
{% block content %}
{% block css %}
    <style>
    .gtc_forms {
    width: 10px;
	border-top: 1px solid #eae9e7;
	margin-top: 40px;
    padding-top: -40px;
    padding-left: 10px;
	{#padding-top: 40px;#}
}

    </style>
{% endblock %}

    {#    <section class="page_title ds s-py-5">#}
    {#        <div class="container">#}
    {#            <div class="row">#}
    {##}
    {#                <div class="col-md-12 text-center">#}
    {#                    <h1 class="bold">Shop Product with Right Sidebar</h1>#}
    {#                    <ol class="breadcrumb">#}
    {#                        <li class="breadcrumb-item">#}
    {#                            <a href="index.html">Home</a>#}
    {#                        </li>#}
    {#                        <li class="breadcrumb-item">#}
    {#                            <a href="#">Shop</a>#}
    {#                        </li>#}
    {#                        <li class="breadcrumb-item active">#}
    {#                            Shop Product with Right Sidebar#}
    {#                        </li>#}
    {#                    </ol>#}
    {#                </div>#}
    {##}
    {#            </div>#}
    {#        </div>#}
    {#    </section>#}



    <section class="ls s-py-80 s-py-md-120 s-py-xl-160">
        <div class="container">
            <div class="row">

                <main class="col-12">
                    <div class="product">

                        <div class="images" data-columns="4">
                            <figure>
                                {% for image in images %}



                                    <div data-thumb="{% thumbnail image.image 1080x720 %}">
                                        <a href="{% thumbnail image.image 1080x720 %}">
                                            <img src="{% thumbnail image.image 1080x720 %}" alt="img" data-caption=""
                                                 data-src="{% thumbnail image.image 1080x720 %}"
                                                 data-large_image="{% thumbnail image.image 1080x720 %}"
                                                    {#                                                 data-large_image_width="1080" data-large_image_height="720">#}>
                                        </a>
                                    </div>
                                {% endfor %}

                                {#										<div data-thumb="images/shop/11_back.jpg">#}
                                {#											<a href="images/shop/11_back.jpg">#}
                                {#												<img src="images/shop/11_back.jpg" alt="img" data-caption="" data-src="images/shop/11_back.jpg" data-large_image="images/shop/11_back.jpg" data-large_image_width="1000" data-large_image_height="1000">#}
                                {#											</a>#}
                                {#										</div>#}
                                {#										<div data-thumb="images/shop/10_back.jpg">#}
                                {#											<a href="images/shop/10_back.jpg">#}
                                {#												<img src="images/shop/10_back.jpg" alt="img" data-caption="" data-src="images/shop/10_back.jpg" data-large_image="images/shop/10_back.jpg" data-large_image_width="1000" data-large_image_height="1000">#}
                                {#											</a>#}
                                {#										</div>#}
                                {#										<div data-thumb="images/shop/10.jpg">#}
                                {#											<a href="images/shop/10.jpg">#}
                                {#												<img src="images/shop/10.jpg" alt="img" data-caption="" data-src="images/shop/10.jpg" data-large_image="images/shop/10.jpg" data-large_image_width="1000" data-large_image_height="1000">#}
                                {#											</a>#}
                                {#										</div>#}


                            </figure>
                        </div>

                        <div class="summary entry-summary">
                            <div class="divider-40"></div>
                            <div class="woocommerce-product-rating">
{#                                <div class="star-rating">#}
{#                                    <span style="width:60%">Rated <strong#}
{#                                            class="rating">3</strong> out of 5 based on <span class="rating">3</span> customer ratings</span>#}
{#                                </div>#}
                            </div>
                            <h1 class="product_title entry-title">{{ object.name }}</h1>
                            <div>
                                <p>{{ object.description }}</p>
                            </div>

                            <div class="pb-10">
                                <h5><p class="price">
											<span class="color-main3">
												<span>P</span>{{ object.price }}
											</span>
                                </p></h5>
                            </div>
                            {#                            <div class="product_meta">#}
{#										<span class="posted_in">Categories:#}
{#											<a href="shop-.html" rel="tag">T-shirts</a>,#}
{#											<a href="shop-.html" rel="tag">man</a>,#}
{#											<a href="shop-.html" rel="tag">logo</a>#}
{#										</span>#}
{#                                <span class="tagged_as">Tags: <a href="shop-.html" rel="tag">clothing</a></span>#}
{##}
{##}
{#                            </div>#}

                            <form>

{#                                <table class="variations">#}
{#                                    <tbody>#}
{#                                    <tr>#}
{##}
{#                                        <td class="value">#}
{#                                            <label for="pa_color">Color</label>#}
{#                                            <select id="pa_color" class="wc-default-select" name="attribute_pa_color"#}
{#                                                    data-attribute_name="attribute_pa_color">#}
{#                                                <option value="">Show all</option>#}
{#                                                <option value="blue" class="attached enabled">Blue</option>#}
{#                                            </select>#}
{#                                        </td>#}
{#                                    </tr>#}
{#                                    <tr>#}
{##}
{#                                        <td class="value">#}
{#                                            <label for="pa_size">Size</label>#}
{#                                            <select id="pa_size" class="wc-default-select" name="attribute_pa_size"#}
{#                                                    data-attribute_name="attribute_pa_size">#}
{#                                                <option value="">Show all</option>#}
{#                                                <option value="x-small" class="attached enabled">X Small</option>#}
{#                                                <option value="small" class="attached enabled">Small</option>#}
{#                                                <option value="medium" class="attached enabled">Medium</option>#}
{#                                                <option value="large" class="attached enabled">Large</option>#}
{#                                                <option value="x-large" class="attached enabled">X Large</option>#}
{#                                                <option value="xx-large" class="attached enabled">XX Large</option>#}
{#                                                <option value="xxx-large" class="attached enabled">XXX Large</option>#}
{#                                            </select>#}
{##}
{#                                        </td>#}
{#                                    </tr>#}
{#                                    </tbody>#}
{#                                </table>#}


                                <div class="gtc_forms">
                                    <div>

                                        {#                                                     <button type="submit" class="single_add_to_cart_button button alt">Add to cart#}
                                        {#                                                                                </button>#}
                                        {#                                        <form method="post" class = "single_add_to_cart_button button alt" action="{% url 'add_to_cart' product.id %}">#}
                                        {#                                            {% csrf_token %}#}
                                        {#                                            <input type="submit" value="Add to cart">#}
                                        {#                                        </form>#}
                                        {% if user.is_authenticated %}
                                            <a rel="nofollow" href="{% url 'cart' %}"
                                               style="display: {% if product.id in cart_items %} block {% else %} none {% endif %}"
                                               class="button product_type_simple add_to_cart_button"
                                               id="go-to-btn-{{ product.id }}">Go To Cart</a>
                                            <a rel="nofollow" href="#" data-product_id="{{ product.id }}"
                                               id="add-btn-{{ product.id }}"
                                               style="display: {% if product.id not in cart_items %} block {% else %} none {% endif %}"
                                               class="button product_type_simple add_to_cart_button add-to-cart">Перейти в корзину</a>
                                        {% else %}
                                            <a rel="nofollow" href="#"
                                               style="display: block"
                                               class="button product_type_simple add_to_cart_button"
                                               id="myButton">Перейти в корзину</a>

                                            <div id="myModal" style="display: none;">
                                                <p>Вы не Зарегистрированы!</p>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>


                            </form>

                        </div>
                    </div>
                </main>

            </div>

        </div>
    </section>

{% endblock %}

{% block scripts %}
    <script>
        // Получаем кнопку и всплывающее окно по их идентификаторам
        var button = document.getElementById("myButton");
        var modal = document.getElementById("myModal");

        // Добавляем обработчик события при клике на кнопку
        button.addEventListener("click", function () {
            // Отображаем всплывающее окно, установив его стилю display в "block"
            modal.style.display = "block";
        });
    </script>
    <script>

        $(document).ready(() => {
            $('.add-to-cart').each((i, element) => {
                $(element).click((e) => {
                    e.preventDefault();
                    let p_id = $(e.target).data('product_id');
                    $("#go-to-btn-" + p_id).show()
                    $("#add-btn-" + p_id).hide()
                    $.post("/add-to-cart/",
                        {
                            product_id: p_id,
                            description: '',
                            csrfmiddlewaretoken: '{{ csrf_token }}'
                        }
                    ).then((data) => {
                        console.log(data)
                    })
                });
            });
        });
    </script>
{% endblock %}